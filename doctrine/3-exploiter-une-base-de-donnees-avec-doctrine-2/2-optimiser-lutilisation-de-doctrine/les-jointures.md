Il est aussi possible de faire des jointures en utilisant le *QueryBuilder*. Comme pour le *fetch mode*, ces jointures permettent d'améliorer les performances de notre application.

Lorsque nous utilisons le paramètre `fetch`, **toutes les requêtes** utiliseront cette jointure. Mais dans certains cas, il n'est pas nécessaire d'utiliser une jointure.

Imaginons, par exemple, une page pour éditer les informations personnelles des utilisateurs. La jointure pour récupérer les participations de celui-ci nous est d'aucune utilité dans ce cas. 

En utilisant le *QueryBuilder* en conjonction avec le *repository* personnalisé, nous pouvons définir des méthodes pour faire des jointures sur les informations qui nous intéressent et les appeler qu'au cas par cas selon le contexte de l'application.

Pour récupérer un utilisateur, son adresse et ses participations, nous pouvons avoir :

```php
<?php
# src/Repository/UserRepository.php

namespace Tuto\Repository;

use Doctrine\ORM\EntityRepository;
use Tuto\Entity\User;

class UserRepository extends EntityRepository
{
    public function find($id)
    {
        $queryBuilder = $this->_em->createQueryBuilder()
           ->select(['u', 'a', 'p']) // récupération des alias obligatoire pour que la jointure soit effective
           ->from(User::class, 'u')
           ->leftJoin('u.address', 'a')
           ->leftJoin('u.participations', 'p')
           ->where('u.id = :id')
           ->setParameter('id', $id);

        $query = $queryBuilder->getQuery();

        return $query->getOneOrNullResult();
    }

   // ...
}
```

Ici, nous avons surchargé la méthode `find` native de *Doctrine*. Ainsi en rajoutant la jointure, nous savons maintenant que **toutes les requêtes** `find` profiterons de cette optimisation.

Nous pouvons aussi bien utiliser des `LEFT JOIN` comme des `INNER JOIN` suivant le résultat que nous souhaitons avoir.

Il faut préférer les jointures manuelles avec des méthodes de *repository* personnalisées au *fetch mode Eager*. Ainsi, vous pourrez garder un contrôle total sur toutes les requêtes que *Doctrine* va exécuter et choisir, selon le contexte, les jointures nécessaires.